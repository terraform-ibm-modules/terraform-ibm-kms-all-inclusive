{
  "products": [
    {
      "name": "deploy-arch-ibm-kms",
      "label": "Cloud automation for Key Protect",
      "product_kind": "solution",
      "tags": [
        "ibm_created",
        "target_terraform",
        "terraform",
        "solution",
        "security",
        "platform_engineering"
      ],
      "keywords": [
        "KMS",
        "Key",
        "Key Ring",
        "Key Protect",
        "IaC",
        "infrastructure as code",
        "terraform",
        "solution"
      ],
      "short_description": "Provisions and configures IBM Cloud Key Protect and creates key rings and keys.",
      "long_description": "With this [IBM Key Protect](https://cloud.ibm.com/docs/key-protect) solution, you can centrally manage encryptions keys to secure sensitive data across IBM Cloud services. It creates key rings to logically group your encryption keys, which helps you manage and control access to them. Then, create keys to enable secure data encryption, key rotation, and lifecycle management in accordance with your organization's security and compliance requirements. <br/><br/>ℹ️ This Terraform-based automation is part of a broader suite of IBM-maintained Infrastructure as Code (IaC) assets, each following the naming pattern \"Cloud automation for *servicename*\" and focusing on single IBM Cloud service. These single-service deployable architectures can be used on their own to streamline and automate service deployments through an [IaC approach](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-understanding-projects), or assembled together into a broader [automated IaC stack](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-config-stack) to automate the deployment of an end-to-end solution architecture.",
      "offering_docs_url": "https://github.com/terraform-ibm-modules/terraform-ibm-kms-all-inclusive/blob/main/solutions/fully-configurable/README.md",
      "offering_icon_url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-kms-all-inclusive/main/images/key_protect_icon.svg",
      "provider_name": "IBM",
      "features": [
        {
          "title": "Key Protect instance",
          "description": "Get started with Key Protect by creating an instance. [Learn more](https://cloud.ibm.com/catalog/services/key-protect#about)."
        },
        {
          "title": "Key rings and keys",
          "description": "Create key rings and keys for data encryption. Both Key Protect and Hyper Protect Crypto Services (HPCS) are supported."
        },
        {
          "title": "Context-based restrictions",
          "description": "Configure [context-based restrictions for access control](https://cloud.ibm.com/docs/key-protect?topic=key-protect-access-control-with-cbr) to the instance of Key Protect."
        }
      ],
      "support_details": "This product is in the community registry, as such support is handled through the [original repo](https://github.com/terraform-ibm-modules/terraform-ibm-kms-all-inclusive). If you experience issues please open an issue [here](https://github.com/terraform-ibm-modules/terraform-ibm-kms-all-inclusive/issues). Please note this product is not supported via the IBM Cloud Support Center.",
      "flavors": [
        {
          "label": "Fully configurable",
          "name": "fully-configurable",
          "index": 1,
          "install_type": "fullstack",
          "working_directory": "solutions/fully-configurable",
          "compliance": {
            "authority": "scc-v3",
            "profiles": [
              {
                "profile_name": "CIS IBM Cloud Foundations Benchmark v1.1.0",
                "profile_version": "1.1.0"
              }
            ]
          },
          "iam_permissions": [
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "kms",
              "notes": "Required to create a Key Protect instance or configure key rings and keys within an existing Key Protect instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "hs-crypto",
              "notes": "[Optional] Required to create key rings and keys for an existing Hyper Protect Crypto Services (HPCS) instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Viewer"
              ],
              "service_name": "Resource group only",
              "notes": "Viewer access is required in the resource group you want to provision in."
            }
          ],
          "configuration": [
            {
              "key": "ibmcloud_api_key"
            },
            {
              "key": "region",
              "required": true,
              "options": [
                {
                  "displayname": "Dallas (us-south)",
                  "value": "us-south"
                },
                {
                  "displayname": "Frankfurt (eu-de)",
                  "value": "eu-de"
                },
                {
                  "displayname": "London (eu-gb)",
                  "value": "eu-gb"
                },
                {
                  "displayname": "Madrid (eu-es)",
                  "value": "eu-es"
                },
                {
                  "displayname": "Osaka (jp-osa)",
                  "value": "jp-osa"
                },
                {
                  "displayname": "Sao Paulo (br-sao)",
                  "value": "br-sao"
                },
                {
                  "displayname": "Sydney (au-syd)",
                  "value": "au-syd"
                },
                {
                  "displayname": "Tokyo (jp-tok)",
                  "value": "jp-tok"
                },
                {
                  "displayname": "Montreal (ca-mon)",
                  "value": "ca-mon"
                },
                {
                  "displayname": "Toronto (ca-tor)",
                  "value": "ca-tor"
                },
                {
                  "displayname": "Washington (us-east)",
                  "value": "us-east"
                }
              ]
            },
            {
              "key": "prefix",
              "required": true,
              "default_value": "dev",
              "random_string": {
                "length": 4
              },
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "Prefix must begin with a lowercase letter and may contain only lowercase letters, digits, and hyphens '-'. It must not end with a hyphen('-'), and cannot contain consecutive hyphens ('--'). It should not exceed 16 characters.",
                  "value": "^$|^__NULL__$|^[a-z](?!.*--)(?:[a-z0-9-]{0,14}[a-z0-9])?$"
                }
              ]
            },
            {
              "key": "key_protect_plan",
              "required": true,
              "options": [
                {
                  "displayname": "Tiered Pricing",
                  "value": "tiered-pricing"
                },
                {
                  "displayname": "Cross Region Resiliency",
                  "value": "cross-region-resiliency"
                }
              ]
            },
            {
              "key": "provider_visibility",
              "options": [
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ],
              "hidden": true
            },
            {
              "key": "existing_resource_group_name",
              "display_name": "resource_group",
              "custom_config": {
                "type": "resource_group",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "identifier": "rg_name"
                }
              }
            },
            {
              "key": "key_protect_instance_name"
            },
            {
              "key": "existing_kms_instance_crn",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'existing_kms_instance_crn' is not valid.",
                  "value": "^__NULL__$|^crn:(.*:){3}(kms|hs-crypto):(.*:){2}[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}::$"
                }
              ]
            },
            {
              "key": "keys",
              "type": "array",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            },
            {
              "key": "rotation_interval_month"
            },
            {
              "key": "kms_endpoint_type",
              "hidden": true,
              "options": [
                {
                  "displayname": "Public",
                  "value": "public"
                },
                {
                  "displayname": "Private",
                  "value": "private"
                }
              ]
            },
            {
              "key": "key_protect_allowed_network",
              "options": [
                {
                  "displayname": "Public and private",
                  "value": "public-and-private"
                },
                {
                  "displayname": "Private only",
                  "value": "private-only"
                }
              ]
            },
            {
              "key": "key_protect_resource_tags",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "key_protect_access_tags",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "key_protect_instance_cbr_rules",
              "type": "array",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            }
          ],
          "architecture": {
            "features": [
              {
                "title": "",
                "description": "Configured to use IBM secure-by-default standards, but you can edit it to fit your use case."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "caption": "Cloud automation for Key Protect - Fully configurable",
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-kms-all-inclusive/main/reference-architectures/deployable-architecture-key-protect.svg",
                  "type": "image/svg+xml"
                },
                "description": "This architecture creates an IBM Cloud Key Protect instance to securely manage encryption keys. It creates key rings to logically organize keys, and generates or imports keys with options for rotation policies. It also configures context-based restrictions to enforce security and compliance."
              }
            ]
          },
          "terraform_version": "1.10.5"
        },
        {
          "label": "Security-enforced",
          "name": "security-enforced",
          "index": 2,
          "install_type": "fullstack",
          "working_directory": "solutions/security-enforced",
          "compliance": {
            "authority": "scc-v3",
            "profiles": [
              {
                "profile_name": "CIS IBM Cloud Foundations Benchmark v1.1.0",
                "profile_version": "1.1.0"
              }
            ]
          },
          "iam_permissions": [
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator"
              ],
              "service_name": "All Identity and Access enabled services",
              "notes": "[Optional] Required to apply context-based restrictions to the Key Protect instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "kms",
              "notes": "Required to create a Key Protect instance or configure key rings and keys within an existing Key Protect instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "hs-crypto",
              "notes": "[Optional] Required to create key rings and keys for an existing Hyper Protect Crypto Services (HPCS) instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Viewer"
              ],
              "service_name": "Resource group only",
              "notes": "Viewer access is required in the resource group you want to provision in."
            }
          ],
          "configuration": [
            {
              "key": "ibmcloud_api_key"
            },
            {
              "key": "region",
              "required": true,
              "options": [
                {
                  "displayname": "Dallas (us-south)",
                  "value": "us-south"
                },
                {
                  "displayname": "Frankfurt (eu-de)",
                  "value": "eu-de"
                },
                {
                  "displayname": "London (eu-gb)",
                  "value": "eu-gb"
                },
                {
                  "displayname": "Madrid (eu-es)",
                  "value": "eu-es"
                },
                {
                  "displayname": "Osaka (jp-osa)",
                  "value": "jp-osa"
                },
                {
                  "displayname": "Sao Paulo (br-sao)",
                  "value": "br-sao"
                },
                {
                  "displayname": "Sydney (au-syd)",
                  "value": "au-syd"
                },
                {
                  "displayname": "Tokyo (jp-tok)",
                  "value": "jp-tok"
                },
                {
                  "displayname": "Montreal (ca-mon)",
                  "value": "ca-mon"
                },
                {
                  "displayname": "Toronto (ca-tor)",
                  "value": "ca-tor"
                },
                {
                  "displayname": "Washington (us-east)",
                  "value": "us-east"
                }
              ]
            },
            {
              "key": "prefix",
              "required": true,
              "random_string": {
                "length": 4
              },
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "Prefix must begin with a lowercase letter and may contain only lowercase letters, digits, and hyphens '-'. It must not end with a hyphen('-'), and cannot contain consecutive hyphens ('--'). It should not exceed 16 characters.",
                  "value": "^$|^__NULL__$|^[a-z](?!.*--)(?:[a-z0-9-]{0,14}[a-z0-9])?$"
                }
              ]
            },
            {
              "key": "key_protect_plan",
              "required": true,
              "options": [
                {
                  "displayname": "Tiered Pricing",
                  "value": "tiered-pricing"
                },
                {
                  "displayname": "Cross Region Resiliency",
                  "value": "cross-region-resiliency"
                }
              ]
            },
            {
              "key": "existing_resource_group_name",
              "display_name": "resource_group",
              "custom_config": {
                "type": "resource_group",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "identifier": "rg_name"
                }
              }
            },
            {
              "key": "key_protect_instance_name"
            },
            {
              "key": "existing_kms_instance_crn",
              "value_constraints": [
                {
                  "type": "regex",
                  "description": "The value provided for 'existing_kms_instance_crn' is not valid.",
                  "value": "^__NULL__$|^crn:(.*:){3}(kms|hs-crypto):(.*:){2}[0-9a-fA-F]{8}(?:-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}::$"
                }
              ]
            },
            {
              "key": "keys",
              "type": "array",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            },
            {
              "key": "rotation_interval_month"
            },
            {
              "key": "key_protect_resource_tags",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "key_protect_access_tags",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "key_protect_instance_cbr_rules",
              "type": "array",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            },
            {
              "key": "provider_visibility",
              "options": [
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ],
              "hidden": true
            }
          ],
          "architecture": {
            "features": [
              {
                "title": "",
                "description": "Configured to use IBM secure-by-default standards that can't be changed."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "caption": "Cloud automation for Key Protect - Security-enforced",
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-kms-all-inclusive/main/reference-architectures/deployable-architecture-key-protect.svg",
                  "type": "image/svg+xml"
                },
                "description": "This architecture creates an IBM Cloud Key Protect instance to securely manage encryption keys and allows only private networks. It creates key rings with private endpoints to logically organize keys, and generates or imports keys with options for rotation policies. It also configures context-based restrictions to enforce security and compliance."
              }
            ]
          },
          "terraform_version": "1.10.5"
        }
      ]
    }
  ]
}
